Hey everybody! Thanks for joining us for another episode of "Forging Titanium"! This week we'll be exploring how we can use Android Services & Intents to launch Android notifications to the status bar. This is a great way to let your users know when there's new content or interaction available in your currently running apps. And fortunately for us Titanium developers, this powerful platform-specific functionality is built right into the core Titanium Javascript API.For those of you unfamiliar with Android Notifications, let take a look at what one typically looks like. Here I have my test application, notify, which demonstrates a few ways you can utilize Android notifications in your apps. The simplest case is an immediate notification based on user interaction. So if we click the "Immediate Notification" button, you'll see that a notification immediately pops up in the status bar, showing us our app's icon and a brief message to go along with it.To show the notification in action, let's leave our app. Now, if we open the status bar's sliding drawer, we see the details of our notification. This includes the app's icon, a title, a brief message, and the time that the notification was launched. If we then click on the notification, the sliding drawer closes and we are immediately taken back to our app. So as you can see, this is an extremely useful feature that can be used to send your users back to your app whenever you'd like. Let's expand on that "whenever you'd like" statement. Let's say you wanted a notification to be launched after a certain amount of time, or at a specific interval. For this we can use pending notifications. To demonstrate, we'll click on the "Pending Notification" button. This will launch a pending notification, based on a pending intent, in 4 seconds. So if we wait... we'll see our notification pops up just like it did before, but this time after the specified interval. In this case we set our pending notification to only be launched once, but you can also set reoccurring intervals. This can be done with a minor modification in the code that we'll discuss in a little bit. Once again we can open up the status bar, click on our notification, and go back to the app.Notifications based on button clicks are an easy way to demonstrate how notifications work, but they aren't the most practical use case. We typically want to launch notifications when our users aren't already interacting with our app. A common case for this would be sending updates from background services. Let's demonstrate how we can do that using Titanium's Geolocation module to receive location events while our app is in the background. Before moving on, though, it's worth noting that your android emulator needs to be configured to support GPS services before you can test this functionality yourself. Also, the emulator has no built-in facility for generating location events, so you'll need to do this via the Dalvik Debug Monitor. Both the configuration of your emulator for location services and using DDMS to send location events are covered in detail in the wiki documentation guide found here... Let's go back to our app and send it to the background by clicking the home button on the emulator. You'll notice that there is currently no GPS data present in the app yet. Now, with our app in the background, let's open DDMS, attach it to our emulator, click on the "Emulator Control" tab, then scroll down to location controls. Here you see how we can send longitude and latitude coordinates to be processed as location events in our Android emulator. Let's click "send" and see what happens... As soon as our app, running in the background, receives the location event, it launches a notification to let us know that is was received. In addition, our app's UI was also updated with the latitude and longitude that was contained in the event. While I used the `Titanium.Geolocation` module as my background service, you can potentially use any background service to launch these types of notifications. You could have native Android notifications letting your users know when an RSS is updated, when they have received a message, or any other noteworthy event you'd like to track.So now that we've seen how notifications behave in the Android OS, let's take a look at the Titanium code necessary to create them.At the very top of the app.js for the notify app, we have the function `createNotificationViaService`, which does exactly what its name implies for all of our events. In it, we create a service intent based off of a Javascript service we've already written, called `ExampleService.js`. This service is the core of our notification functionality, and we'll get to the code for it shortly.After we've created our service intent, we add any additional information we'd like to use via Intent Extras, like a message or time interval, and then launch the service. If you didn't specify an interval, the notification will be launched immediately. If you did, the notification will be launched after the specified amount of milliseconds, regardless of whether or not your app is still in the foreground.The rest of the code in the app.js is primarily UI construction and setting up events that will eventually call the `createNotificationViaService` function. We use simple click handlers for the buttons... we add the `orientationchange` handler to the `Ti.Gesture` module in order to alert on orientation changes... and as we just demonstrated, we set up a location event listener on the `Ti.Gelocation` module. One quick note is that in this simple app the location event listener will run constantly, whether in the foreground or background. This can be a real drain on a device's battery and should only be done when you absolutely need constant access to GPS information. once again, the location services guide in the wiki documentation covers how to manage location events in a power efficient manner. Inside `ExampleService.js` is where all of the notifications background work is performed. 